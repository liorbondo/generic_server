/*****************************************
Author: 			 			Lior Bondorevsky
Creation date: 			17/12/2014
Last modofied date: 20/12/2014
Description: 				FileServer Protocols 
*****************************************/
#ifndef __FILESERVER_PROTOCOLOS__
#define __FILESERVER_PROTOCOLOS__


namespace adv_cpp
{

class FileServerHeader;

// Base class. Used only by inheritors
class FileServerProtocol
{
protected:
  FileServerProtocol(const char* ip, short port, int id); 
  ~FileServerProtocol();
  
  // Write Socket data into a file
  bool WriteSocketToFile(const char* fileName);
  
  int m_fd;
  int m_id;
  FileServerHeader* m_recvHeader;
};

struct IpPort;

class RepoProtocol : public FileServerProtocol
{
public: 
  RepoProtocol(const char* ip, short port, int id);
  // ~RepoProtocol() = default;
  
  // Recieve the repository files list
  // Return false for error & true if transfer & MD5ChkSum OK
  bool Discovery(const char* outputFilePath);
  
  // Get the pair of IP:PORT for requested file for GET
  // Return false for error & true if OK
  bool GetServersForGet(const char* fileName, IpPort*, IpPort*);   
};

} // namespace adv_cpp

#endif /* #ifndef __FILE_SERVER_PROTOCOLOS__ */
